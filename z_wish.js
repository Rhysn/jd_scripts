 /*
活动入口：京东众筹-众筹许愿池
短期活动
已支持IOS京东双账号,云端N个京东账号
脚本兼容: QuantumultX, Surge, Loon, JSBox, Node.js
注：会自动关注任务中的店铺跟商品，介意者勿使用。
=====================================Quantumult X=================================
[task_local]
10 10 13-20 3 * https://raw.githubusercontent.com/i-chenzhe/qx/main/z_wish.js, tag=众筹许愿池, enabled=true
=====================================Loon================================
[Script]
cron "10 10 13-20 3 *" script-path=https://raw.githubusercontent.com/i-chenzhe/qx/main/z_wish.js,tag=众筹许愿池
======================================Surge==========================
众筹许愿池 = type=cron,cronexp="10 10 13-20 3 *",wake-system=1,timeout=3600,script-path=https://raw.githubusercontent.com/i-chenzhe/qx/main/z_wish.js
====================================小火箭=============================
众筹许愿池 = type=cron,script-path=https://raw.githubusercontent.com/i-chenzhe/qx/main/z_wish.js, cronexpr="10 10 13-20 3 *", timeout=3600, enable=true
*/
const $ = new Env('众筹许愿池');
const notify = $.isNode() ? require('./sendNotify') : '';
const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';
const JD_API_HOST = 'https://api.m.jd.com/client.action/';
//Node.js用户请在jdCookie.js处填写京东ck;
//IOS等用户直接用NobyDa的jd cookie
let cookiesArr = [], cookie = '', message = '', assistList = [];
if ($.isNode()) {
    Object.keys(jdCookieNode).forEach((item) => {
        cookiesArr.push(jdCookieNode[item])
    })
    if (process.env.JD_DEBUG && process.env.JD_DEBUG === 'false') console.log = () => {
    };
} else {
    let cookiesData = $.getdata('CookiesJD') || "[]";
    cookiesData = JSON.parse(cookiesData);
    cookiesArr = cookiesData.map(item => item.cookie);
    cookiesArr.reverse();
    cookiesArr.push(...[$.getdata('CookieJD2'), $.getdata('CookieJD')]);
    cookiesArr.reverse();
    cookiesArr = cookiesArr.filter(item => item !== "" && item !== null && item !== undefined);
}
  var _0xodS='jsjiami.com.v6',_0x44b8=[_0xodS,'H8ONEQRl','w6l+FMOOUQ==','w5hRwo8/EQ==','CVYPwoUmw5fCh8OWNcOJDH0sw4LClsOEwpnDq2E5wqvDiMKiw4wCw65jIxt7w5PDpXXDqTRTVMOYNcOyVMKOO8OLN3HClWPDgsO1wqpoLAfCmjbCrMO3wo5NGFzDk8O+wr3DhQc8VV7DmVfCg8KcwoNEwobDih4+wrrDnlloGDrCtMKiw75Gw6XDi8Ocw4Rpw4/Dh8K1w4PCribDmQpgJQQFb3TClQ3DiMOlYcK2CUovwqhuHMKPAMOcw6DDngh/QMKSw602PsKQwpnCqHTCucOLDhjChsO7wrsKwqzCn8K5w5LCrsKCGV8fB2XDlcKtwq/Ch30Mw5AgIV7Dp1lkACTCosK8wrN6M1PCqXMZw5Viwr9TPsKAwpXCrsKWFsO5w7/DpWbDlCnCoMOcwqnCjg==','wqXCvjNfKg==','ESEFE8KnTjM7LsOiw74=','w5jDhMOlThBL','a8OuFFjCp8OXw5A+wrk6w4IiMMO0eU3DiVHCrBtcKMK3RgYLw5jCtwUVXg==','wrfCncOIw70=','F8KdwrzCt8OFwr0=','QnJsHA==','wrPCk8OIw6IhTjw=','bV4Lw4DDuho=','w619wrUFEyfDsg==','fMOjSV8hwr7CnsKZ','ajnDkHsbPA==','V8ODa8OqQgjDjg0=','w6V8JsOFcVYbworDng==','w7kWw7cD','McO/wrnDhCDCug==','Kyk/XsKXw7zDtRQ=','w58Dwq3Dr8KnwpzDlsKfwrU=','XMKnS0xPwppCw73DhnpvwovDgSQ=','wrLCgcOew7s2Vi7CvHTCiiPCuVxuWgzDrsOv','wrnDn0sTdD0xBSfCh8OdRsO/w5IJbx1L','YcOdw4Nx4pWmw4fmi5/liJjkuJM=','KsKqw5XCiw==','w6vCqMKHTkbDrllnw64ew4NWFMKiw5vCn8OrQg==','wq3CsMOew6gZYDjCr2LCnTbCtw==','A8O/HQc=','wovDlcOvWCgBw7TDhMO7w7Bkw6nCuMK+w6ImCVU=','IsOgNytBZcOmwoLCk0LChcKB','wrbDuMOj','CHVwwoI=','w5Vewp0twplo','w7HCn8KAw4pKJnHDncO5wqkUw5LDucKYwpIRXDo=','K8K/woYwHMKmFUnDp8K5U1w=','fh5w','ElYJwpw7worDgcKfJA==','BcKJwovCjkzCkw==','w4bjgrzkuoLkub3otJPljr0=','XcKoXGZA','w7Mew6AJEMKVAXE=','w67miavliaXkuozkuYPkuL7kuJ3opbbvvrLkvJLmmJnmlZzmsZ7liJXmlp7nsYjlnIDvv5zorZrohZfooY/mnYXnnLfmlJvmj7rjg4lK','SDjDtlVEFGxtWw==','aMKyLjjDusOW','w44RwrzDvA==','w40kasK9w5wK','KcKcwpAeBcKJMlrDusKtYEHCgMOp','DiY/CcK/','OsO3fW3iloLCguWul+aLp+S5leWKl++9ieiPp+W8kQ==','BXsFGg==','GMOcbg98wrk=','EkEUwocw','UMKnTGI=','w7UWw7AtKcKaPGZMwrPDgMKrVEA=','NsOpwq/Dgx/CrS/DsUc=','P8OoC0TCrsON','wr/Dr8Ow','AsKQLsK44pSXRg==','BMKYworCkk7CgH7DkWM=','5Lmm5Lug5pyH5YmA5Zia6L6x5ZqP56qw5pSU5o2x','GzsMNcKhVQ==','wqnCuUjDjcOz','XMKyTHNLw449wqDDhG8nwpjDhTTDusKaLCpTwqg7HVMew7M9DiDCgkgIW8Kjw5/DhDtOHsKIQA3DhknCvMOpS8O+wrrDk8OaPcKEw5zCvg==','XMKyTHNLw449wqDDgWVnwpzCmzDDusKaLCpTwqg7HUsUw5wrfiDCgkhPXcKgw5zChXVqD8KVZSfCrEnCusO+bMO1wqrDncOjbsOfwpXCpcKPJcKNSg==','GMKUUTN9wqpwd8KuwoESEkBlw4jCuEc=','w6M/T8O1LA==','wrYhGCLClg==','FW0DI8ON','SFoyw57DuQ==','MsOqwo7DlzU=','fsK+HibDpg==','w5HCs8KvT0o=','FMOww7B/bA==','H8OKeAhZwqNKUg==','TsOfacOdeRQ=','wrjCssKQwoh3','wqrCrl3DqMO4','cS/Dr2EQIW8=','FcO7HQVbwr3Diw==','fsK2KSw=','E8KTwqjCvcOAwqEzw7IzCsOkw6RHwqI=','OMOhMnzDig==','wr3DqcO0eMO1w4PDlh0=','PznDiMOE','wqvCowMoO8K2w47DiQ==','w6bCjcKWw51CP3bDgA==','djXDgGUZKWzDhA==','AD49JcK+','K3ELOcO7','wpLCo8KTwqZqO8KPR0UDw4U3GSAwDRHDucOLHcKzwozDuMKpWR7DvMO2PUM3Szs=','cCjDl34Eci7CjmxUOl/DogRnTyjCv8KQ','XDbDrUwGU2FuRBnDgsOyworDtsOVw4JG','wonCu8OOwqlt','RMKFOcKXGMOhw7cnw6Unw7XDtcOiQsKNw4bCm3B4wqR4VMOVw7how6sVwojCgMOTbxtzw4PCnsOlwp0=','aMOgXEEBwrPCmcKCXGLCmG0COsODGQ==','6ISh5p2g54uM5pyQCgU1JRB/5pmX5pS25pSZ6ZSuw4/CkgTCpMKBw43Dm3vCpEbDjMK/w53CrnoNwrjChOS6keW6qO++qsKeI1gwwrrCrcOBT3cFw5LChH0rwpF2wqxuMhhVw4PDp3jDj2Zqw6J0DnPDuMKmwqFR','w49PwpoowoYmKcOCw7XDmcOBU8O8YmDDjk5Yw4XDgAxF','5p+D54GF5LiW6Kae6L6p6LWD','GzsM','YMKrC8KDEQ==','T8ODaQ==','AnVpwoY=','44G65o2p56Sn44Gr6K+n5YaF6I6b5Y+r5LmC5LmW6LaQ5YyO5Lubwq3Cmy3DuMKfwpdt55u45o6c5Lyb55a4V2cQFVvCqOebsuS6uuS4vOetiOWKkOiMv+WOoA==','FsKkwpvCiEg=','GMOyw6lLUQ==','RhEtIsKEXjs=','w4MaQ8OOFQ==','wqDDiUAGQSI=','S3JsHsOi','wqHDjVoCXQ==','TMOZbcOzRQfDhQc=','LsO4KBFk','IcOiHw==','wpolacKdCB9e5b+45aWw44KQ5Lmt5Lmc6Le15Y+9','w5YvfcKtw4g=','wovCowMoPMK5w4XDgw==','VcOEEml7wqA+OMOiw6c=','EsKBwpfCncOQwqYN','FcKTwrbClw==','44CK5oyH56Wn44Gcw7XDjXTCnMOHU+W2t+WloeaXjg==','wq8rIwvCgcOdVkk=','V+iuoemFsOaUvueZr+W/uOiPj+WPk0LCvcKEVwIJOXHCtGUFw5nCjxQfQ0FPfcKjKsOxFg==','AFISCMOR','S8ODQMO3bwM=','PcKuw4/CjgDCrR5MBXo=','w4QRwqXDuA==','RXx3FsOjcOW3s+WkueaVmMKvw6xc','DsOdYCfDlW/CpQU=','wobDs8OyYcO1w4PDlh0=','wpjorpjph6rmlJHnmJvlv4/ojLvljpBBEFjDqjdA','HcKaw5TCixo=','H8Ovw47CmsOr','UzjDsExZSSokQwXDisKowp3DqMKHw4FNwrjDk8KPwoZnw6MTw5HDvcKOw68nWcOiw6BtUsOewpIyVA==','w51/wo8swpQ=','EUMJwoYw','w6jCg8KC','w4EhXsOtBg==','CsO8wovDhhw=','w5c1bcK4w4NEZA9RdMK9wrZfHMKkw7XCp0TDuADDiB0xw4LCv8KjC8KadSxQecKgw6A=','ORXDiMOfdQ==','wr/CgDhmOg==','D8OcMkrDgQ==','wqfDgcOQSsO6','C8OJbRZ5wq5NScKHJcOYw5bCscK9wpsswr/DlsKGAnRNS8OgdWkbAjPDqVw5Cg==','w6thwrgawo0=','w7h7N8OHUQ9bw5fDk8K1w68tw71gYMOpdMOywq5fwrPCk8OXf2htdsOdw4nDtcKYwprDpsO/DcOVQcKFWC9FIcO/VHrDnTgsw41Fw5DCgmLCh1ddwrvCssOICnMAw4QvIsO3H8Oya8OdDMK0YXIDw64bKmEow5tQw63CnTtCwoFdPMOMw5PDl1TCnMKULcOZFy3DnMO1JWfDr8Ogw45c','R1Uawoxow53CjsKVM8KbHzZuw4nChsOXw5zDt2Vyw7TCj8K1w4cxw4t4P1Uc','wpTDhMOQX8Oz','w6jDkCjClAEAI8KEBXLCgjclw4bCgE5Twpd5woHDrm3Du8OmJDnDukjDrMOZe8K7wok6S8OvLjLCmCY=','F27DsU9PAVViQVfCmcKkw43Cp8OTw4NYw7/DlcKOwp91w74fw4rCucKMw7EpXcOlw7oUXsOCwoU+Qy7DtMKmw4BQLkI=','D8KBSzc=','BcK8XTA=','RMKnSnBd','I8KKw7fCjyw=','w4pwwog4Hw==','W8Oia8OcYg==','R8KySmpWwpN7w6nDkA==','U8KxHDrDhg==','W8KhDMKoJg==','aDV2wpHDjg==','w6DCjcKRw5k=','F8KXwrXClcODwqc=','wrXDtcOCWQ8=','wrTCkjR+Ig==','E8KNwozCmg==','w7rCusKWXQ==','C8OaaTNU','w77CqMKEw4xq','H8KTwq/Ckw==','wqvCn37Ckjsh','w7DCncKRcmw=','wqnCsQ8u','w4t5wrU=','KcKXwqg=','wovCrkbDscOsdA==','w5Elw7UaEg==','KcK9w6vCriw=','Rzt+wrLDhw==','BWdKwozDl8Kq','O8OHPC5hS8OlworCh18=','wqnCk8OWw6w=','DFEc','w5EgdMKt','wqPDtMOtYsOr','w4kRwrzDvsKc','w74AQA==','MDs3SQ==','wpZHw5wkw4FgNcKRwqc=','w7F9wrQDKibDuMKJwovCvMOycxXDvWYSwr/Ck0AU','NcKmwqDClFY=','AsOcfBZkwqVVecKPM8Opwp7CvsK6wrwtw77Ck8K2BnhY','w6stIsOHUnwQw5rCgcKi','LMO9CHjCpg==','SMKVPw5xwr5HacKBIcOTwpfDucO0w5Zgwr/DlMKRD21XCsO1dUEWTiXDuAs=','w6kWw7AJCMKbHw==','Vi3DvGhDHmB4','WMKYIMKCGA==','C8KPSygFw6V/d8Km','A8KNwovCkG7ChnrDkg==','JsKqw5PChyHCrBN6AGzCuS0EGsOFw5XChzfDl8Ks','M8KAMzpfbcO1w4HDmwQ=','w6jDkCjClRMWOsKeC3TCgns9w57CgA==','wrjDjV0KfC4=','V8OQwrrCkcODwqYMw64IA8Oxw7MRw6F/w7JYJg==','5beJ57qD5ayI5ois5omq5p26','Az0GFcKg','PcKjw47Cmj7CqwRCImDCoSgXEMOFw7/CsjfDlg==','wrXDqcO7Z8Oew5A=','LiLDnMO6YcOe','MTnDmg==','AMOcw6/CmsOoH8KmwqAiNFfDqcOAw4PDiEjCiH3DusKP','csKyTV0YwpnCnMOUDy8=','wqbDgMOHw4xqInvDu8OywrEyw53CuMOKw5U=','W8KWwqhMWMKCw7ljwovCt2k=','UnJrFsODcQ==','HcOYdA4=','5beq57qT5ayv5oie5oi35p2B','FUMIwp4bwozDhcKc','f8OnVV8Y','wqPCty1eKsOIZHo=','GH1pwobDgA==','woPCocKMwq52O8KaekIKw4RODn4=','w6LChcKJw4xuIw==','H2BlwpfDhsK8','GHUJwrYN','ElIXwpwh','wqbCk20=','KsO3w4XCmMOx','YcO1PD3DpsOrf8OVwpQU','wqAyMCnCqw==','VsORfcOzXwnDgwcO','wrBDBcOVAcOpw6cPRl0N','CjF5HsO+fG5mRMO2wrEZwoZCw5NUw55W','wrIjYcODQ0YfwqzDlMOrwqQuw7EwJg==','FUMIwp4BwoLDg8KcMw==','wp1tO8K8w5ENIGlUJsOu','fsOxRVk=','EMO/ABJwwqzDnEFlw63CjcOW','5baV57mR5a+l5om25om05p+Q','QMKnS2h2wpV/w6o=','w71uO8OjS1gRwos=','w5NSwoM9woY=','w74KScOGFMOy','w6YOVMOKLsO7w6Ej','C8OOCgly','w5FSwqnDrcKEwrbDncOPw6oK','wq3DnF4oUQ==','XcOCGjcww7l/W8Ksw49J','KTfDjsOlXcOJ','CjF5HsO+fG5mRMO2wrEZwoZCw5NVw55W','H8Ocw7TCgw==','wp/CvMKE','5baN57ih5a605omT5oiR5p6D','w6rCusKRV0nDuFVw','wq0tJw==','5rSx5Ymc5Yqj5Ym656Gz5YmV5p295Z+65YuN5YqE5rKH','Li8pRA==','FsKfwovCklPCk0PDlmnCusOcwqTCkzJ8w5nCvk8=','K8OsGVzCqg==','wqvCowMoIcK7w4fDlHQ=','DMOJw69KcMKfw7RF','acK0Mj/Ds8OyfsKFw6JZMSTDo2PCtA==','wrLCvwE=','NMOUw6Z6dg==','UCnDgH9H','JnTDnMO+ZMOkHCdyw7XDkg==','wr/CoBYTFg==','CMOcfBQ=','GOOBoeS6u+S7uei2ieWMtw==','cTLDh2sP','BMOQfhFewqxBWA==','w6oyfMK6w74fJkU=','OFbCgy5XaOKUleiMluW+kw==','wq7DiU8P','MjbDiMOAKBw7w7nCnsKfwq4Lw5p2wpvCrcKiGR/DicOew4/DmcOyf0XCmH8FXQTDmglW','AicOAsKARDMnAg==','RMKFOcKXGMOhw7cnw6Unw7XDtcO9XsKVw4PDjD10wqY6GMOTw7Ujw6cAw5TChsORchwzw4k=','GsKCwqvCnsOewqwCw7Q1FcOvwrlLw7YqwrUNdm1VwpcywpvDnBnCsR4oIgvCgMK/Bg==','EsOfw69IFMKQw75DwpnDsA==','jOsjQAJlOIiamiN.zCbcoSOmN.BvW6=='];(function(_0x28f8af,_0x57a2da,_0x7e92d0){var _0x496792=function(_0x3d7b2d,_0xf917fe,_0xa5da08,_0x55b96d,_0x2f7855){_0xf917fe=_0xf917fe>>0x8,_0x2f7855='po';var _0x2d8a72='shift',_0x19d73f='push';if(_0xf917fe<_0x3d7b2d){while(--_0x3d7b2d){_0x55b96d=_0x28f8af[_0x2d8a72]();if(_0xf917fe===_0x3d7b2d){_0xf917fe=_0x55b96d;_0xa5da08=_0x28f8af[_0x2f7855+'p']();}else if(_0xf917fe&&_0xa5da08['replace'](/[OQAJlOINzCbSONBW=]/g,'')===_0xf917fe){_0x28f8af[_0x19d73f](_0x55b96d);}}_0x28f8af[_0x19d73f](_0x28f8af[_0x2d8a72]());}return 0x77fb7;};return _0x496792(++_0x57a2da,_0x7e92d0)>>_0x57a2da^_0x7e92d0;}(_0x44b8,0x174,0x17400));var _0x2255=function(_0x2fca1d,_0x11ac4c){_0x2fca1d=~~'0x'['concat'](_0x2fca1d);var _0x5bc775=_0x44b8[_0x2fca1d];if(_0x2255['xznTnY']===undefined){(function(){var _0x170f15=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x5b5eb4='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x170f15['atob']||(_0x170f15['atob']=function(_0x17593d){var _0x4cd43f=String(_0x17593d)['replace'](/=+$/,'');for(var _0x572053=0x0,_0x78a182,_0x3b06f6,_0x84416b=0x0,_0x13aff8='';_0x3b06f6=_0x4cd43f['charAt'](_0x84416b++);~_0x3b06f6&&(_0x78a182=_0x572053%0x4?_0x78a182*0x40+_0x3b06f6:_0x3b06f6,_0x572053++%0x4)?_0x13aff8+=String['fromCharCode'](0xff&_0x78a182>>(-0x2*_0x572053&0x6)):0x0){_0x3b06f6=_0x5b5eb4['indexOf'](_0x3b06f6);}return _0x13aff8;});}());var _0x48f47e=function(_0x900967,_0x11ac4c){var _0x2c96f1=[],_0x14aaf8=0x0,_0x124766,_0x541164='',_0xfb9b2e='';_0x900967=atob(_0x900967);for(var _0x3497b0=0x0,_0x2e646e=_0x900967['length'];_0x3497b0<_0x2e646e;_0x3497b0++){_0xfb9b2e+='%'+('00'+_0x900967['charCodeAt'](_0x3497b0)['toString'](0x10))['slice'](-0x2);}_0x900967=decodeURIComponent(_0xfb9b2e);for(var _0x2daf7c=0x0;_0x2daf7c<0x100;_0x2daf7c++){_0x2c96f1[_0x2daf7c]=_0x2daf7c;}for(_0x2daf7c=0x0;_0x2daf7c<0x100;_0x2daf7c++){_0x14aaf8=(_0x14aaf8+_0x2c96f1[_0x2daf7c]+_0x11ac4c['charCodeAt'](_0x2daf7c%_0x11ac4c['length']))%0x100;_0x124766=_0x2c96f1[_0x2daf7c];_0x2c96f1[_0x2daf7c]=_0x2c96f1[_0x14aaf8];_0x2c96f1[_0x14aaf8]=_0x124766;}_0x2daf7c=0x0;_0x14aaf8=0x0;for(var _0x16986f=0x0;_0x16986f<_0x900967['length'];_0x16986f++){_0x2daf7c=(_0x2daf7c+0x1)%0x100;_0x14aaf8=(_0x14aaf8+_0x2c96f1[_0x2daf7c])%0x100;_0x124766=_0x2c96f1[_0x2daf7c];_0x2c96f1[_0x2daf7c]=_0x2c96f1[_0x14aaf8];_0x2c96f1[_0x14aaf8]=_0x124766;_0x541164+=String['fromCharCode'](_0x900967['charCodeAt'](_0x16986f)^_0x2c96f1[(_0x2c96f1[_0x2daf7c]+_0x2c96f1[_0x14aaf8])%0x100]);}return _0x541164;};_0x2255['jmZLnb']=_0x48f47e;_0x2255['gYpFjB']={};_0x2255['xznTnY']=!![];}var _0x299349=_0x2255['gYpFjB'][_0x2fca1d];if(_0x299349===undefined){if(_0x2255['ClhXfD']===undefined){_0x2255['ClhXfD']=!![];}_0x5bc775=_0x2255['jmZLnb'](_0x5bc775,_0x11ac4c);_0x2255['gYpFjB'][_0x2fca1d]=_0x5bc775;}else{_0x5bc775=_0x299349;}return _0x5bc775;};!(async()=>{var _0x1c6127={'wRSml':function(_0x24f0e3){return _0x24f0e3();},'IfAwP':function(_0x5880f7){return _0x5880f7();},'zNeYm':'api.m.jd.com','dCuQa':_0x2255('0','dqQM'),'qVmly':_0x2255('1','vbe0'),'gwIAF':_0x2255('2','to$f'),'tAGYA':'keep-alive','LZVBx':'jdapp;iPhone;9.4.0;14.3;;network/wifi;ADID/;supportApplePay/0;hasUPPay/0;hasOCPay/0;model/iPhone10,3;addressid/;supportBestPay/0;appBuild/167541;jdSupportDarkMode/0;Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2014_3\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20Mobile/15E148;supportJDSHWK/1','GDGLH':_0x2255('3','dqQM'),'SlNVZ':_0x2255('4','&(zg'),'yReDi':_0x2255('5','hUJZ'),'LZFdz':_0x2255('6','to$f'),'aHcsh':_0x2255('7','RInQ'),'Qudou':function(_0x5baf9b,_0x472550){return _0x5baf9b<_0x472550;},'SQuaT':function(_0xe9d86c,_0x51dd8a){return _0xe9d86c+_0x51dd8a;},'wPAOM':function(_0x479501){return _0x479501();},'KSHsf':function(_0x52f204,_0x96eea9){return _0x52f204<_0x96eea9;},'nFsNk':function(_0x5d5b32,_0x55ee29,_0xf2596a){return _0x5d5b32(_0x55ee29,_0xf2596a);},'LRvxL':function(_0x23d850,_0x2a312a,_0x28a4ff){return _0x23d850(_0x2a312a,_0x28a4ff);},'gvJDb':function(_0xe67b23){return _0xe67b23();},'UJiWh':function(_0x21761a,_0x22928d){return _0x21761a!==_0x22928d;},'ptzqP':_0x2255('8','QDj[')};$[_0x2255('9','Bw9r')](_0x1c6127[_0x2255('a','&(zg')]);if(!cookiesArr[0x0]){$[_0x2255('b','I3^P')]($[_0x2255('c','Arg)')],_0x2255('d','Y21*'),_0x1c6127[_0x2255('e','M3Ga')],{'open-url':_0x1c6127[_0x2255('f','^rtv')]});return;}$['appId']=_0x2255('10','Bw9r');for(let _0x366c98=0x0;_0x1c6127[_0x2255('11','%xbU')](_0x366c98,cookiesArr[_0x2255('12','M8ZF')]);_0x366c98++){if(cookiesArr[_0x366c98]){cookie=cookiesArr[_0x366c98];$['UserName']=decodeURIComponent(cookie[_0x2255('13','2IoC')](/pt_pin=(.+?);/)&&cookie[_0x2255('14','M8ZF')](/pt_pin=(.+?);/)[0x1]);$['index']=_0x366c98+0x1;$['isLogin']=!![];$[_0x2255('15','I3^P')]='';await _0x1c6127[_0x2255('16','YVra')](checkCookie);console[_0x2255('17','l#Fl')](_0x2255('18','NuVK')+$[_0x2255('19','6G!Q')]+'】'+($['nickName']||$[_0x2255('1a','AS]E')])+_0x2255('1b','nC7b'));if(!$[_0x2255('1c','#nAw')]){$['msg']($[_0x2255('1d','#nAw')],_0x2255('1e','1PIU'),'京东账号'+$['index']+'\x20'+($[_0x2255('1f','m$Wr')]||$['UserName'])+_0x2255('20','(W@y'),{'open-url':_0x1c6127[_0x2255('21','#FOa')]});if($[_0x2255('22','I3^P')]()){await notify[_0x2255('23','Bqn$')]($[_0x2255('24','qyar')]+_0x2255('25','2IoC')+$[_0x2255('26','3AJR')],'京东账号'+$['index']+'\x20'+$[_0x2255('27','V2Zd')]+_0x2255('28','%xbU'));}else{$['setdata']('','CookieJD'+(_0x366c98?_0x1c6127[_0x2255('29','Bqn$')](_0x366c98,0x1):''));}continue;}if(helpAuthor){function _0x176e16(){var _0x4a62f7={'SNyLf':function(_0x4ac0ee){return _0x1c6127[_0x2255('2a','k5BC')](_0x4ac0ee);}};return new Promise(_0x4d0072=>{$['get']({'url':_0x2255('2b','to$f')},(_0x341c3e,_0xf1ebaa,_0x4a5a8b)=>{try{if(_0x4a5a8b){$[_0x2255('2c','RInQ')]=JSON[_0x2255('2d','ql5E')](_0x4a5a8b);};}catch(_0x144225){console[_0x2255('2e','qJl&')](_0x144225);}finally{_0x4a62f7[_0x2255('2f','%xbU')](_0x4d0072);};});});}function _0x49f08e(_0x56c73f,_0x3213c5){var _0x278fd8={'mAVeb':function(_0x3134a2){return _0x1c6127[_0x2255('30','cDLm')](_0x3134a2);}};let _0x42ce6e={'url':_0x2255('31','6G!Q'),'headers':{'Host':_0x1c6127['zNeYm'],'Content-Type':_0x1c6127[_0x2255('32','(W@y')],'Origin':_0x1c6127[_0x2255('33','3TQG')],'Accept-Encoding':_0x1c6127[_0x2255('34','ERQ&')],'Cookie':cookie,'Connection':_0x1c6127[_0x2255('35','V2Zd')],'Accept':_0x2255('36','Y21*'),'User-Agent':_0x1c6127[_0x2255('37','RInQ')],'Referer':_0x2255('38','NuVK')+_0x56c73f+_0x2255('39','ql5E'),'Accept-Language':_0x1c6127[_0x2255('3a','V2Zd')]},'body':'functionId=cutPriceByUser&body={\x22activityId\x22:\x22'+_0x56c73f+_0x2255('3b','QDj[')+_0x3213c5+_0x2255('3c','to$f')};return new Promise(_0x21574c=>{$[_0x2255('3d','nC7b')](_0x42ce6e,(_0x543268,_0x34af4b,_0x3bffb1)=>{if(_0x3bffb1){$[_0x2255('3e','nC7b')]=JSON[_0x2255('3f','naXP')](_0x3bffb1);_0x278fd8[_0x2255('40','Bqn$')](_0x21574c);};});});}function _0x1f00bc(_0x49736e,_0x566c7f){let _0x47cee9={'url':_0x1c6127[_0x2255('41','#6Wt')],'headers':{'Content-Type':_0x1c6127[_0x2255('42','I3^P')]},'body':JSON[_0x2255('43','naXP')]({'actID':_0x49736e,'actsID':_0x566c7f,'done':0x1})};return new Promise(_0x40c8e9=>{var _0xcd9ce0={'osAiK':function(_0x5edde5){return _0x1c6127[_0x2255('44','1PIU')](_0x5edde5);}};$['post'](_0x47cee9,(_0x20fb02,_0x1ada8e,_0x47a8cf)=>{_0xcd9ce0['osAiK'](_0x40c8e9);});});}await _0x1c6127[_0x2255('45','&(zg')](_0x176e16);if($[_0x2255('46','0UjJ')][_0x2255('47','qJl&')][_0x2255('48','#nAw')]!==0x0){for(let _0x366c98=0x0;_0x1c6127[_0x2255('49','(cg!')](_0x366c98,$[_0x2255('4a','3TQG')][_0x2255('4b','M3Ga')]['length']);_0x366c98++){actID=$['zData'][_0x2255('4c','ncYh')][_0x366c98][_0x2255('4d','Y21*')];actsID=$[_0x2255('4e','qJl&')][_0x2255('4f','#nAw')][_0x366c98][_0x2255('50','QDj[')];await _0x1c6127[_0x2255('51','ncYh')](_0x49f08e,actID,actsID);await $[_0x2255('52','AS]E')](0x5dc);if($[_0x2255('53','#6Wt')]&&$[_0x2255('54','#nAw')][_0x2255('55','&!%D')]===0x4){await _0x1c6127[_0x2255('56','cqpH')](_0x1f00bc,actID,actsID);}};};};await _0x1c6127[_0x2255('57','Bqn$')](wish);}}if(_0x1c6127[_0x2255('58','0UjJ')](message,'')){if($[_0x2255('59','Arg)')]()){await notify[_0x2255('5a','IiEu')]($[_0x2255('5b','hzeG')],message);}else{$[_0x2255('5c','ql5E')]($[_0x2255('5d','6G!Q')],_0x1c6127[_0x2255('5e','V2Zd')],message);}}})()[_0x2255('5f','qyar')](_0x2b9233=>{$[_0x2255('60','%xbU')]('','❌\x20'+$[_0x2255('61','m!Hc')]+',\x20失败!\x20原因:\x20'+_0x2b9233+'!','');})['finally'](()=>{$['done']();});async function wish(){var _0xe94e94={'BJXov':function(_0x123cfc,_0x502ccb,_0x6dae54){return _0x123cfc(_0x502ccb,_0x6dae54);},'xgaQy':function(_0x574d3d,_0x1cd41d){return _0x574d3d>_0x1cd41d;},'TPsEm':function(_0x102c72,_0x5be5d3){return _0x102c72>_0x5be5d3;},'vwyrp':function(_0x21c137,_0x3321e6){return _0x21c137-_0x3321e6;},'yWrCX':_0x2255('62','RInQ'),'zncna':_0x2255('63','#6Wt'),'Mlppx':function(_0x3802ee,_0x524a9e){return _0x3802ee>_0x524a9e;},'zGdYv':function(_0x131a82,_0x5bab3f){return _0x131a82<_0x5bab3f;},'lPcoF':function(_0x223f4e,_0xec7c43,_0x4a1331){return _0x223f4e(_0xec7c43,_0x4a1331);},'OYaoz':function(_0xc06cd3,_0xc32a99){return _0xc06cd3<_0xc32a99;},'hHrQZ':function(_0x3e50c4,_0x249a0f){return _0x3e50c4(_0x249a0f);},'faamh':function(_0x1d31c0,_0x5daa38){return _0x1d31c0/_0x5daa38;},'MnlBO':'去抽奖','keDCm':'interact_template_getLotteryResult'};$['bean']=0x0;await _0xe94e94[_0x2255('64','M3Ga')](doSomething,_0x2255('65','Y21*'),_0x2255('66','NuVK')+$[_0x2255('67','l#Fl')]+_0x2255('68','Y21*'));if($[_0x2255('69','cqpH')]){for(const _0x297585 of $['taskVos']){switch(_0x297585['taskType']){case 0xd:if(_0xe94e94['xgaQy'](_0x297585[_0x2255('6a','to$f')]-_0x297585[_0x2255('6b','&(zg')],0x0)){taskToken=_0x297585['simpleRecordInfoVo'][_0x2255('6c','nC7b')];$['log']('执行'+_0x297585[_0x2255('6d','M3Ga')]);await doSomething(_0x2255('6e','Bqn$'),_0x2255('6f','IiEu')+$['appId']+_0x2255('70','QDj[')+taskToken+'\x22,\x22taskId\x22:'+_0x297585[_0x2255('71','M8ZF')]+_0x2255('72','#nAw'));await $['wait'](0x3e8);}else{$['log'](_0x2255('73','to$f')+_0x297585['taskName']+'任务');}break;case 0x1a:if(_0x297585['maxTimes']-_0x297585[_0x2255('74','Bw9r')]>0x0){taskTokenList=_0x297585[_0x2255('75','Bqn$')][_0x2255('76','V2Zd')](_0x2bb1fc=>_0x2bb1fc[_0x2255('77','(W@y')]===0x1);for(const _0x3110a8 of taskTokenList){$[_0x2255('78','(W@y')]('执行'+_0x297585['taskName']);await doSomething(_0x2255('79','k5BC'),_0x2255('7a','hUJZ')+$[_0x2255('67','l#Fl')]+_0x2255('7b','qJl&')+_0x3110a8['taskToken']+_0x2255('7c','^rtv')+_0x297585[_0x2255('7d','2IoC')]+',\x22actionType\x22:\x220\x22}');await $[_0x2255('7e','Y21*')](0x3e8);}}else{$['log'](_0x2255('7f','vbe0')+_0x297585[_0x2255('80','ql5E')]+'任务');}break;case 0x8:if(_0xe94e94['TPsEm'](_0xe94e94[_0x2255('81','hUJZ')](_0x297585[_0x2255('82','3TQG')],_0x297585[_0x2255('83','Arg)')]),0x0)){taskTokenList=_0x297585[_0x2255('84','dqQM')][_0x2255('85','qJl&')](_0x177743=>_0x177743[_0x2255('86','Arg)')]===0x1);for(const _0x4247e2 of taskTokenList){var _0x236584=_0xe94e94[_0x2255('87','ql5E')][_0x2255('88','ql5E')]('|'),_0x15931a=0x0;while(!![]){switch(_0x236584[_0x15931a++]){case'0':await $['wait'](0x3e8);continue;case'1':$[_0x2255('89','QDj[')]('执行'+_0x297585['taskName']);continue;case'2':await _0xe94e94[_0x2255('8a','k5BC')](doSomething,_0xe94e94['zncna'],_0x2255('8b','1PIU')+$[_0x2255('8c','m$Wr')]+'\x22,\x22taskToken\x22:\x22'+_0x4247e2[_0x2255('8d','I3^P')]+_0x2255('8e','%xbU')+_0x297585['taskId']+_0x2255('8f','2IoC'));continue;case'3':await doSomething(_0xe94e94['zncna'],'{\x22appId\x22:\x22'+$['appId']+_0x2255('90','NuVK')+_0x4247e2[_0x2255('91','ql5E')]+_0x2255('92','6G!Q')+_0x297585[_0x2255('7d','2IoC')]+',\x22actionType\x22:\x220\x22}');continue;case'4':await $[_0x2255('93','hUJZ')](0x3e8*_0x297585[_0x2255('94','YVra')]);continue;}break;}}}else{$['log'](_0x2255('95','YVra')+_0x297585[_0x2255('96','naXP')]+'任务');}break;case 0xe:if(_0xe94e94['Mlppx'](_0x297585[_0x2255('97','NuVK')]-_0x297585[_0x2255('98','RInQ')],0x0)){for(let _0x11ea70=0x0;_0xe94e94['zGdYv'](_0x11ea70,assistList[_0x2255('99','%xbU')]);_0x11ea70++){$['log']('执行'+_0x297585[_0x2255('9a','%xbU')]);await _0xe94e94[_0x2255('9b','YVra')](doSomething,_0xe94e94['zncna'],_0x2255('9c','qyar')+$[_0x2255('9d','M8ZF')]+'\x22,\x22taskToken\x22:\x22'+assistList[_0x11ea70]+_0x2255('9e','nC7b')+_0x297585[_0x2255('9f','(W@y')]+_0x2255('a0','2IoC'));await $[_0x2255('a1','k5BC')](0x7d0);}}else{$[_0x2255('a2','dqQM')](_0x2255('a3','nC7b')+_0x297585[_0x2255('a4','ncYh')]+'任务');}$[_0x2255('a5','m$Wr')](_0x2255('a6','QDj['));assistList[_0x2255('a7','m!Hc')](_0x297585[_0x2255('a8','M3Ga')]['taskToken']);break;default:break;}}}if($['userScore']){for(let _0x3f8fb3=0x0;_0xe94e94['OYaoz'](_0x3f8fb3,_0xe94e94['hHrQZ'](parseInt,_0xe94e94[_0x2255('a9','l#Fl')]($[_0x2255('aa','AS]E')],$[_0x2255('ab','^rtv')][_0x2255('ac','1PIU')])));_0x3f8fb3++){$[_0x2255('ad','AS]E')](_0xe94e94[_0x2255('ae','^rtv')]);await doSomething(_0xe94e94[_0x2255('af','to$f')],_0x2255('b0','(W@y')+$[_0x2255('b1','AS]E')]+'\x22}');await $[_0x2255('7e','Y21*')](0x3e8);}}if($[_0x2255('b2','Y21*')]>0x0){message+=_0x2255('b3','0UjJ')+$[_0x2255('b4','vbe0')]+'】'+($[_0x2255('b5','Y21*')]||$[_0x2255('b6','6G!Q')])+_0x2255('b7','vbe0')+$[_0x2255('b8','M8ZF')]+'个京豆';}}function doSomething(_0x2b2d6b,_0x21acaa){var _0x47f62f={'qUOLV':_0x2255('b9','S]DF'),'hVdeY':'jBeanAwardVo','yrTyl':'score','IgkKs':_0x2255('ba','Bw9r'),'QcoHj':function(_0x56e1d7){return _0x56e1d7();},'xSxbQ':_0x2255('bb','&(zg'),'ObNpU':_0x2255('bc','#nAw'),'yqWys':'gzip,\x20deflate,\x20br','vwDQr':_0x2255('bd','^rtv'),'AMIQT':'application/json,\x20text/plain,\x20*/*','khfUi':'zh-cn'};let _0x920aff={'url':_0x47f62f[_0x2255('be','YVra')],'headers':{'Content-Type':_0x47f62f['ObNpU'],'Accept-Encoding':_0x47f62f[_0x2255('bf','NuVK')],'Cookie':cookie,'Connection':_0x47f62f['vwDQr'],'Accept':_0x47f62f[_0x2255('c0','#6Wt')],'User-Agent':'jdapp;iPhone;9.3.6;14.3;network/wifi;ADID/;supportApplePay/0;hasUPPay/0;hasOCPay/0;model/iPhone10,3;addressid/97911903;supportBestPay/0;appBuild/167521;jdSupportDarkMode/0;pv/31.10;apprpd/;ref/JDWebViewController;psq/6;ads/;psn/;jdv/;adk/;app_device/IOS;pap/JA2015_311210|9.3.6|IOS\x2014.3;Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2014_3\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20Mobile/15E148;supportJDSHWK/1','Referer':_0x2255('c1','ql5E'),'Accept-Language':_0x47f62f[_0x2255('c2','3TQG')]},'body':_0x2255('c3','Bw9r')+_0x2b2d6b+_0x2255('c4','(cg!')+_0x21acaa+_0x2255('c5','l#Fl')};return new Promise(_0x2d64eb=>{$[_0x2255('c6','hzeG')](_0x920aff,(_0x1c2a15,_0x1ce37a,_0x50102e)=>{try{if(_0x1c2a15){$[_0x2255('c7','#nAw')](_0x1c2a15);}else{if(_0x50102e){_0x50102e=JSON['parse'](_0x50102e);if(_0x50102e[_0x2255('c8','2IoC')]['success']){switch(_0x2b2d6b){case'healthyDay_getHomeData':$[_0x2255('c9','hzeG')]=_0x50102e['data'][_0x2255('ca','ZcJa')][_0x2255('cb','#6Wt')];$[_0x2255('cc','hUJZ')]=_0x50102e[_0x2255('4b','M3Ga')][_0x2255('cd','vbe0')][_0x2255('ce','I3^P')];$[_0x2255('cf','NuVK')]=_0x50102e[_0x2255('d0','cqpH')][_0x2255('d1','cDLm')][_0x2255('d2','m!Hc')][_0x2255('d3','qyar')];break;case _0x47f62f['qUOLV']:if(_0x50102e['data']['result'][_0x2255('d4','naXP')](_0x2255('d5','hzeG'))){if(_0x50102e['data']['result'][_0x2255('d6','M8ZF')]['hasOwnProperty'](_0x47f62f['hVdeY'])){$['log'](_0x2255('d7','!upu')+_0x50102e[_0x2255('d8','Bqn$')]['result'][_0x2255('d9','ncYh')][_0x2255('da','hzeG')]['quantity']+'个'+_0x50102e[_0x2255('db','YVra')]['result'][_0x2255('dc','(cg!')][_0x2255('dd','IiEu')][_0x2255('de','V2Zd')]);$['bean']+=parseInt(_0x50102e[_0x2255('df','Arg)')][_0x2255('e0','RInQ')][_0x2255('e1','qJl&')][_0x2255('e2','!upu')]['quantity']);}else{$[_0x2255('e3','0UjJ')]('\x20\x20\x20\x20└\x20抽到了'+JSON[_0x2255('e4','ql5E')](_0x50102e['data'][_0x2255('e5','M3Ga')]));message+=_0x2255('e6','M8ZF')+$[_0x2255('e7','naXP')]+'】'+($[_0x2255('e8','cqpH')]||$['UserName'])+_0x2255('e9','3TQG')+JSON[_0x2255('ea','to$f')](_0x50102e[_0x2255('d8','Bqn$')][_0x2255('eb','1PIU')]);}}break;default:if(_0x50102e[_0x2255('ec','qyar')][_0x2255('ed','6G!Q')][_0x2255('ee','!upu')](_0x47f62f[_0x2255('ef','Bw9r')])){$['log'](_0x2255('f0','1PIU')+_0x50102e[_0x2255('f1','#FOa')][_0x2255('f2','Y21*')][_0x2255('f3','ql5E')]+'积分');}if(_0x50102e[_0x2255('f4','naXP')][_0x2255('e5','M3Ga')][_0x2255('f5','cqpH')](_0x47f62f['IgkKs'])){$[_0x2255('f6','cDLm')]=_0x50102e[_0x2255('4b','M3Ga')][_0x2255('f7','l#Fl')]['userScore'];}break;}}else{$[_0x2255('f8','V2Zd')](_0x2255('f9','I3^P')+JSON[_0x2255('fa','M3Ga')](_0x50102e['data']['bizMsg']));}}else{$[_0x2255('17','l#Fl')](_0x2255('fb','QDj['));}}}catch(_0x2db8fe){$[_0x2255('fc','Bw9r')](_0x2db8fe,_0x1ce37a);}finally{_0x47f62f[_0x2255('fd','&!%D')](_0x2d64eb);}});});}function checkCookie(){var _0x26ba27={'mJzGU':'1001','qPhTL':_0x2255('fe','naXP'),'wcXBY':'me-api.jd.com','twrXt':'keep-alive','WaJko':'Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2014_3\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20Version/14.0.2\x20Mobile/15E148\x20Safari/604.1','qpDfy':'zh-cn','diCkp':_0x2255('ff','naXP'),'OhMsM':_0x2255('100','nC7b')};const _0x26fb33={'url':_0x26ba27[_0x2255('101','%xbU')],'headers':{'Host':_0x26ba27[_0x2255('102','m$Wr')],'Accept':'*/*','Connection':_0x26ba27[_0x2255('103','#FOa')],'Cookie':cookie,'User-Agent':_0x26ba27[_0x2255('104','ZcJa')],'Accept-Language':_0x26ba27[_0x2255('105','cDLm')],'Referer':_0x26ba27[_0x2255('106','1PIU')],'Accept-Encoding':_0x26ba27[_0x2255('107','ncYh')]}};return new Promise(_0x30231c=>{var _0x52698f={'KasBt':function(_0x42fc0d,_0x16decd){return _0x42fc0d===_0x16decd;},'Rtzma':_0x26ba27[_0x2255('108','^rtv')],'PJIwM':_0x2255('109','Y21*'),'wjVUm':'京东返回了空数据','JkzBB':function(_0x1d7ef6){return _0x1d7ef6();}};$['get'](_0x26fb33,(_0x4396a9,_0x2c6873,_0x502ca4)=>{try{if(_0x4396a9){$[_0x2255('10a','I3^P')](_0x4396a9);}else{if(_0x502ca4){_0x502ca4=JSON[_0x2255('3f','naXP')](_0x502ca4);if(_0x52698f[_0x2255('10b','dqQM')](_0x502ca4['retcode'],_0x52698f[_0x2255('10c','&!%D')])){$[_0x2255('10d','vbe0')]=![];return;}if(_0x502ca4[_0x2255('10e','YVra')]==='0'&&_0x502ca4[_0x2255('10f','1PIU')][_0x2255('110','#nAw')](_0x52698f[_0x2255('111','ERQ&')])){$[_0x2255('112','V2Zd')]=_0x502ca4[_0x2255('113','S]DF')][_0x2255('114','AS]E')][_0x2255('115','qJl&')][_0x2255('116','vbe0')];}}else{$[_0x2255('f8','V2Zd')](_0x52698f[_0x2255('117','Bw9r')]);}}}catch(_0x37933e){$['logErr'](_0x37933e);}finally{_0x52698f[_0x2255('118','#FOa')](_0x30231c);}});});};_0xodS='jsjiami.com.v6';
 // prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
